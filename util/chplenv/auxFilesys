#!/usr/bin/env perl

use File::Basename;

$utildirname = dirname($0);

$home = $ENV{'CHPL_HOME'};
if ( ! -d $home ) {
  $home = $utildirname . "/../../";
}

$preset_aux_fs = $ENV{'CHPL_AUX_FILESYS'};

if ($preset_aux_fs eq "") {
  $aux_fs = 'none';
} 

if ($preset_aux_fs eq "hdfs"){
  $java_subdir = $ENV{'JAVA_INSTALL'};
  $aux_fs_subdir = $ENV{'HADOOP_INSTALL'};
  # This will not check that all dependencies are satisfied..
  if (-d $java_subdir && -d $aux_fs_subdir && -f "$aux_fs_subdir/src/c++/libhdfs/hdfs.h" && -d "$java_subdir/include") {
  } else {
      warn "WARNING: Can't find your Java and Hadoop installations\n";
  }
  $aux_fs = 'hdfs';
} else {
  $aux_fs = 'none';
}

print "$aux_fs\n";
exit(0);
