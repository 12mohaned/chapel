

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basics of Initialization &mdash; chpldoc 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="chpldoc 0.0.1 documentation" href="../index.html"/>
        <link rel="next" title="Record Copying in Chapel" href="13.html"/>
        <link rel="prev" title="Alternative Initializer Features" href="11.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> chpldoc
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">chpldoc documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="1.html">Chapel Improvement Proposals</a></li>
<li class="toctree-l1"><a class="reference internal" href="10.html">Initializers</a></li>
<li class="toctree-l1"><a class="reference internal" href="11.html">Alternative Initializer Features</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Basics of Initialization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#abstract">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rationale">Rationale</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description">Description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#record-initialization">Record Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#class-initialization">Class Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-documents">Related Documents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="13.html">Record Copying in Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="14.html">Chapel stack traces</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.html">Constrained Generics</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.html">ZeroMQ Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="4.html">Constructor Syntax and Semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.html">Implement Object Copying Using a &#8220;Postblit&#8221; Method</a></li>
<li class="toctree-l1"><a class="reference internal" href="6.html">Tuple Semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="7.html">Rules for inserting autoCopy</a></li>
<li class="toctree-l1"><a class="reference internal" href="8.html">Error Handling in Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="9.html">Chapel Package Manager</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">chpldoc</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Basics of Initialization</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/12.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="basics-of-initialization">
<span id="initialization"></span><h1>Basics of Initialization<a class="headerlink" href="#basics-of-initialization" title="Permalink to this headline">¶</a></h1>
<dl class="docutils">
<dt>Status:</dt>
<dd>Draft</dd>
<dt>Authors:</dt>
<dd>Michael Ferguson</dd>
</dl>
<div class="section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>A description of what constitutes initialization and the different kinds
of initialization in Chapel programs for non-generic records and
non-generic classes.</p>
</div>
<div class="section" id="rationale">
<h2>Rationale<a class="headerlink" href="#rationale" title="Permalink to this headline">¶</a></h2>
<p>This document provides common language for describing initialization
and some basic understanding of when initialization occurs. While the
current language specification covers these topics, this document was
created as part of a group of CHIPs to do with improvements to
initializers and initialization. Thus, this document focuses on
behaviors specific to the new design.</p>
<p>This document provides background for <a class="reference internal" href="10.html#initializers"><span>Initializers</span></a> and
<a class="reference internal" href="13.html#record-copies"><span>Record Copying in Chapel</span></a>.</p>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>When a new Chapel variable is created, it is initialized. In other words,
it is set to some initial state.</p>
<p>In the discussion below, we will assume that <cite>R</cite> is a non-generic record
and <cite>C</cite> is a non-generic class.</p>
<div class="section" id="record-initialization">
<h3>Record Initialization<a class="headerlink" href="#record-initialization" title="Permalink to this headline">¶</a></h3>
<p>This section applies to non-generic records.  Also, these examples are meant
to be introductory. While these examples should be correct with respect
to all planned ways to reduce unnecessary record copies, the details of
these are discussed in other documents.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">R</span><span class="p">;</span>
</pre></div>
</div>
<p><cite>x</cite> is automatically initialized by a call to <cite>x.init()</cite>.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">R</span> <span class="o">=</span> <span class="k">noinit</span><span class="p">;</span>
</pre></div>
</div>
<p><cite>x</cite> is automatically initialized by a call to <cite>x.init(noinit=true)</cite>.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">R</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">R</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">args</span><span class="o">&gt;</span><span class="p">);</span>
<span class="c1">// or, equivalently</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">R</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">args</span><span class="o">&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p><cite>x</cite> is initialized by a call to <cite>x.init(&lt;args&gt;)</cite>.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">R</span> <span class="o">=</span> <span class="o">..</span><span class="p">.;</span>
<span class="kd">var</span> <span class="nx">y</span><span class="p">:</span><span class="nx">R</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
<span class="o">..</span><span class="p">.</span> <span class="nx">uses</span> <span class="nx">of</span> <span class="nx">both</span> <span class="nx">x</span> <span class="nx">and</span> <span class="nx">y</span> <span class="o">..</span><span class="p">.</span>
</pre></div>
</div>
<p>We say that <cite>y</cite> is <cite>copy initialized</cite> from <cite>x</cite>. Since <cite>x</cite> and <cite>y</cite> both
exist after <cite>y</cite> is initialized and they are different record variables,
they must not be observed to alias. That is, modifications to a field in
<cite>x</cite> should not cause the corresponding field in <cite>y</cite> to change.</p>
<p>Note that at the time of this writing, specific syntax for specifying how
a record should be <cite>copy initialized</cite> is still under discussion.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">record</span> <span class="nc">MyRecord</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">field</span><span class="p">:</span><span class="nx">R</span><span class="p">;</span>

  <span class="k">proc</span> <span class="nf">init</span><span class="p">(</span><span class="kd">const</span> <span class="kd">ref</span> <span class="nx">arg</span><span class="p">:</span><span class="nx">R</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">field</span> <span class="o">=</span> <span class="nx">arg</span><span class="p">;</span>   <span class="c1">// Note Here</span>
    <span class="nx">super</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This example shows field initialization. The statement <cite>field = arg</cite>
causes <cite>field</cite> to be <cite>copy initialized</cite> from <cite>arg</cite>.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="k">proc</span> <span class="nf">returnR</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">ret</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">R</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">args</span><span class="o">&gt;</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">ret</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">R</span> <span class="o">=</span> <span class="nx">returnR</span><span class="p">();</span>
</pre></div>
</div>
<p><cite>x</cite> is initialized to have the same value as <cite>ret</cite>. There are several
possible mechanisms for how this can be accomplished, but <cite>x</cite> does not
necessarily need to be <cite>copy initialized</cite> from <cite>ret</cite>. This case is
discussed in more detail in <a class="reference internal" href="13.html#record-copies"><span>Record Copying in Chapel</span></a>.</p>
<p>There are many other situations beyond the examples above in which <cite>copy
initialization</cite> occurs. The document <a class="reference internal" href="13.html#record-copies"><span>Record Copying in Chapel</span></a> describes these
in detail.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">R</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">y</span><span class="p">:</span><span class="nx">R</span><span class="p">;</span>
<span class="o">..</span><span class="p">.;</span>
<span class="nx">x</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
</pre></div>
</div>
<p>The statement <cite>x = y</cite> here is called assignment. It is different from
initialization. It will be translated to a call to the <cite>=</cite> operator with
the arguments <cite>x</cite> and <cite>y</cite>. Assignment is different from initialization
because in assignment, the left-hand-side variable has already been
initialized and is being set again.</p>
</div>
<div class="section" id="class-initialization">
<h3>Class Initialization<a class="headerlink" href="#class-initialization" title="Permalink to this headline">¶</a></h3>
<p>This section is a about non-generic classes.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">C</span><span class="p">;</span>
</pre></div>
</div>
<p><cite>x</cite> is automatically initialized to <cite>nil</cite>.</p>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">C</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">C</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">args</span><span class="o">&gt;</span><span class="p">);</span>
<span class="c1">// or, equivalently</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">C</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">args</span><span class="o">&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p><cite>x</cite> is automatically initialized to the result of:</p>
<blockquote>
<div><ol class="arabic simple">
<li>allocating memory for a class instance of type <cite>C</cite></li>
<li>invoking <cite>x.init(&lt;args&gt;)</cite> to initialize that instance</li>
</ol>
</div></blockquote>
<div class="highlight-chapel"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">x</span><span class="p">:</span><span class="nx">C</span> <span class="o">=</span> <span class="o">..</span><span class="p">.;</span>
<span class="kd">var</span> <span class="nx">y</span><span class="p">:</span><span class="nx">C</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
</pre></div>
</div>
<p><cite>y</cite> and <cite>x</cite> point to the same class instance. We can say that the
variable <cite>y</cite> is initialized from the variable <cite>x</cite>. That initialization
just amounts to copying a pointer value and no user-defined initializer
is invoked.</p>
</div>
<div class="section" id="related-documents">
<h3>Related Documents<a class="headerlink" href="#related-documents" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="10.html#initializers"><span>Initializers</span></a> describes how initializers can be specified</li>
<li><a class="reference internal" href="13.html#record-copies"><span>Record Copying in Chapel</span></a> describes exactly when copy or move
initialization occur.</li>
</ul>
</div></blockquote>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="13.html" class="btn btn-neutral float-right" title="Record Copying in Chapel" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="11.html" class="btn btn-neutral" title="Alternative Initializer Features" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, .

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 



</body>
</html>