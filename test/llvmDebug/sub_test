#!/usr/bin/env bash

LLVM=`$CHPL_HOME/util/chplenv/chpl_llvm.py`
PLAT=`$CHPL_HOME/util/chplenv/chpl_platform.py --target`

# We test it only if we're on linux64 with LLVM
if [ "$LLVM" != "llvm" ]; then
echo "[Skipping test based on environment settings]";
exit 0;
fi

if [ "$PLAT" != "linux64" ]; then
echo "[Skipping test based on environment settings]";
exit 0;
fi


python llvmDebug_test.py > llvmDebug_test.out.tmp
if ! diff llvmDebug_test.out.tmp llvmDebug_test.good; then
echo "[Error matching debug info for llvmDebug_test]";
else
echo "[Success matching debug info for llvmDebug_test]";
fi
rm llvmDebug_test.out.tmp
rm llvmDebug_test
