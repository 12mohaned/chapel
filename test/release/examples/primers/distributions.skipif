#!/usr/bin/env python

# Our KNC test machines with don't have enough nodes to run this test, so just
# skip if cnselect says we have less than 6 KNC nodes. This isn't a particular
# elegant solution, but oh well.

import subprocess
import os

try:
    if os.getenv('CHPL_TARGET_ARCH') == 'knc':
        p = subprocess.Popen(["cnselect", "type.eq.MIC", "-c"], stdout=subprocess.PIPE)
        out = p.communicate()[0]

        num_kncs = int(out.strip())

        print(num_kncs < 6)
    else:
        print("False")


# if there's any errors (e.g. cnselect isn't availble, don't skip the test)
except:
    print("False")
