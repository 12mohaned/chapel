#!/usr/bin/env python

"""
Testing BLAS module requires cray-libsci for compiling:
    - $CRAY_LIBSCI_PREFIX_DIR/include/cblas.h
    - $CRAY_LIBSCI_PREFIX_DIR/lib/*sci_gnu*.a (-lsci_gnu)

Therefore we only test on XC, cray-prgenv-gnu target platform, non-whitebox,
and non-llvm configurations.
"""

from os import getenv, path

isXC = getenv('CHPL_TARGET_PLATFORM') == 'cray-xc'
isGNU = 'gnu' in str(getenv('CHPL_TARGET_COMPILER'))
isWB = not path.exists('/etc/opt/cray/release') or not path.exists('/etc/opt/cray/release/CLEinfo')
isLLVM = '--llvm' in str(getenv('COMPOPTS'))

if isXC and isGNU and not isWB and not isLLVM:
  print(False) # Don't skip
else:
  print(True) # Do skip
