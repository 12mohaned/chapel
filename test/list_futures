#!/usr/bin/perl

$printusage = 0;

$username = "";
if (@ARGV) {
    $flag = shift @ARGV;
    if ($flag eq "--help" || $flag eq "-h") {
        $printusage = 1;
    } else {
        $username = $flag;
    }
    if (@ARGV) {
        $printusage = 1;
    }
}

if ($printusage) {
    print "list_futures [<username>]\n";
    exit 0;
}

if ($username ne "") {
    print "***running for user: $username\n";
}


@fnames = `find \* | grep \'\\\.future\$\'`;

foreach $fname (@fnames) {
  chomp $fname;
  $worker = `head -n 1 $fname`;
  chomp $worker;
  $fname =~ s/(.*)\.future$/$1/;
  if (index($worker, $username) != -1) {
      print "$worker [$fname]\n";
  }
}
